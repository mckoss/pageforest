/* Begin file: namespace.js */
if(!window.console){(function(){var noop=function(){};var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];window.console={};for(var i=0;i<names.length;++i){window.console[names[i]]=noop;}}());}
(function(){var sGlobal='global_namespace';if(window[sGlobal]){return;}
function Namespace(nsParent,sName){if(sName){sName=sName.replace(/-/g,'_');}
this._nsParent=nsParent;if(this._nsParent){this._nsParent[sName]=this;this._sPath=this._nsParent._sPath;if(this._sPath!==''){this._sPath+='.';}
this._sPath+=sName;}else{this._sPath='';}}
Namespace.prototype.extend=function(oDest,var_args){if(oDest===undefined){oDest={};}
for(var i=1;i<arguments.length;i++){var oSource=arguments[i];for(var prop in oSource){if(oSource.hasOwnProperty(prop)){oDest[prop]=oSource[prop];}}}
return oDest;};var ns=window[sGlobal]=new Namespace(null);ns.extend(Namespace.prototype,{define:function(sPath,fnCallback){sPath=sPath.replace(/-/g,'_');var aPath=sPath.split('.');var nsCur=this;for(var i=0;i<aPath.length;i++){var sName=aPath[i];if(nsCur[sName]===undefined){var nsNew=new Namespace(nsCur,sName);}
nsCur=nsCur[sName];}
if(fnCallback){if(!nsCur._fDefined){nsCur._fDefined=true;fnCallback(nsCur);}else{console.warn("WARNING: Namespace '"+nsCur._sPath+"' redefinition.");}}else if(!nsCur._fDefined){console.warn("Namespace '"+nsCur._sPath+"' forward reference.");}
return nsCur;},lookup:function(sPath){return window[sGlobal].define(sPath);},nameOf:function(sInNamespace){sInNamespace=sInNamespace.replace(/-/g,'_');return sGlobal+'.'+this._sPath+'.'+sInNamespace;},isOwn:function(object,name){return Object.prototype.hasOwnProperty.call(object,name);}});}());
/* Begin file: base.js */
global_namespace.define('org.startpad.base',function(NS){NS.extend(NS,{Browser:{version:parseInt(navigator.appVersion),fIE:navigator.appName.indexOf("Microsoft")!==-1},ExtendMissing:function(oDest,var_args)
{if(oDest==undefined)
oDest={};for(var i=1;i<arguments.length;i++)
{var oSource=arguments[i];for(var prop in oSource)
{if(oSource.hasOwnProperty(prop)&&oDest[prop]==undefined)
oDest[prop]=oSource[prop];}}
return oDest;},Enum:function(aEnum)
{if(!aEnum)
return;var j=0;for(var i=0;i<aEnum.length;i++)
{if(typeof aEnum[i]=="string")
this[aEnum[i]]=j++;else
j=aEnum[i];}},Project:function(obj,asProps)
{var objT={};for(var i=0;i<asProps.length;i++)
objT[asProps[i]]=obj[asProps[i]];return objT;},DeDupArray:function(a)
{if(!a)
return;a.sort();for(var i=1;i<a.length;i++)
{if(a[i-1]==a[i])
a.splice(i,1);}},Map:function(a,fn)
{var aRes=[];for(var i=0;i<a.length;i++)
aRes.push(fn(a[i]));return aRes;},Filter:function(a,fn)
{var aRes=[];for(var i=0;i<a.length;i++)
{if(fn(a[i]))
aRes.push(a[i]);}
return aRes;},Reduce:function(a,fn)
{if(a.length<2)
return a[0];var res=a[0];for(var i=1;i<a.length-1;i++)
res=fn(res,a[i]);return res;}});NS.StBuf=function()
{this.rgst=[];this.Append.apply(this,arguments);this.sListSep=", ";};NS.StBuf.prototype={constructor:NS.StBuf,Append:function()
{for(var ist=0;ist<arguments.length;ist++)
this.rgst.push(arguments[ist].toString());return this;},Clear:function()
{this.rgst=[];},toString:function()
{return this.rgst.join("");},AppendList:function()
{var sSep="";for(var ist=0;ist<arguments.length;ist++)
{var sT=arguments[ist];if(sT)
{this.Append(sSep+sT);sSep=this.sListSep;}}
return this;}};Function.prototype.FnMethod=function(obj)
{var _fn=this;return function(){return _fn.apply(obj,arguments);};};Function.prototype.FnArgs=function()
{var _fn=this;var _args=[];for(var i=0;i<arguments.length;i++)
{_args.push(arguments[i]);}
return function(){var args=[];var self=this;for(var i=0;i<arguments.length;i++)
{args.push(arguments[i]);}
for(i=0;i<_args.length;i++)
{args.push(_args[i]);}
return _fn.apply(self,args);};};});
/* Begin file: vector.js */
global_namespace.define('org.startpad.vector',function(ns){ns.extend(ns,{x:0,y:1,x2:2,y2:3,subFrom:function(v1,v2)
{for(var i=0;i<v1.length;i++)
{v1[i]=v1[i]-v2[i%v2.length];}
return v1;},sub:function(v1,v2)
{var vDiff=ns.copy(v1);return ns.subFrom(vDiff,v2);},addTo:function(vSum)
{for(var iarg=1;iarg<arguments.length;iarg++)
{var v=arguments[iarg];for(var i=0;i<vSum.length;i++)
{vSum[i]+=v[i%v.length];}}
return vSum;},add:function()
{var vSum=ns.copy(arguments[0]);var args=ns.copy(arguments);args[0]=vSum;return ns.addTo.apply(undefined,args);},max:function()
{var vMax=ns.copy(arguments[0]);for(var iarg=1;iarg<arguments.length;iarg++)
{var v=arguments[iarg];for(var i=0;i<vMax.length;i++)
{if(v[i]>vMax[i])
{vMax[i]=v[i];}}}
return vMax;},mult:function()
{var vProd=1;var i;for(var iarg=0;iarg<arguments.length;iarg++)
{var v=arguments[iarg];if(typeof v==="number")
{if(typeof vProd==="number")
{vProd*=v;}
else
{for(i=0;i<vProd.length;i++)
{vProd[i]*=v;}}}
else
{if(typeof vProd==="number")
{var vT=vProd;vProd=ns.copy(v);for(i=0;i<vProd.length;i++)
{vProd[i]*=vT;}}
else
{if(v.length!==vProd.length)
{throw new Error("Mismatched Vector Size");}
for(i=0;i<vProd.length;i++)
{vProd[i]*=v[i];}}}}
return vProd;},floor:function(v)
{var vFloor=[];for(var i=0;i<v.length;i++)
{vFloor[i]=Math.floor(v[i]);}
return vFloor;},dotProduct:function()
{var v=ns.mult.apply(undefined,arguments);var s=0;for(var i=0;i<v.length;i++)
{s+=v[i];}
return s;},append:function()
{var v1=[].concat.apply([],arguments);return v1;},equal:function(v1,v2)
{if(typeof v1!=typeof v2)
return false;if(typeof v1=='undefined')
return true;for(var i=0;i<v1.length;i++)
{if(v1[i]!==v2[i])
{return false;}}
return true;},ul:function(rc)
{return rc.slice(0,2);},lr:function(rc)
{return rc.slice(2,4);},size:function(rc)
{return ns.sub(ns.lr(rc),ns.ul(rc));},numInRange:function(num,numMin,numMax)
{return num>=numMin&&num<=numMax;},clipToRange:function(num,numMin,numMax)
{if(num<numMin)
return numMin;if(num>numMax)
return numMax;return num;},ptInRect:function(pt,rc)
{return ns.numInRange(pt[ns.x],rc[ns.x],rc[ns.x2])&&ns.numInRange(pt[ns.y],rc[ns.y],rc[ns.y2]);},ptClipToRect:function(pt,rc)
{return[ns.clipToRange(pt[ns.x],rc[ns.x],rc[ns.x2]),ns.clipToRange(pt[ns.y],rc[ns.y],rc[ns.y2])];},rcClipToRect:function(rc,rcClip)
{return ns.append(ns.ptClipToRect(ns.ul(rc),rcClip),ns.ptClipToRect(ns.lr(rc),rcClip));},rcExpand:function(rc,ptSize)
{return ns.append(ns.sub(ns.ul(rc),ptSize),ns.add(ns.lr(rc),ptSize));},keepInRect:function(rcIn,rcBound)
{var ptFixSize=ns.max([0,0],ns.sub(ns.size(rcIn),ns.size(rcBound)));rcIn[ns.x2]-=ptFixSize[ns.x];rcIn[ns.y2]-=ptFixSize[ns.y];var dx=0;dy=0;dx=Math.max(0,rcBound[ns.x]-rcIn[ns.x]);dy=Math.max(0,rcBound[ns.y]-rcIn[ns.y]);if(dx==0)
dx=Math.min(0,rcBound[ns.x2]-rcIn[ns.x2]);if(dy==0)
dy=Math.min(0,rcBound[ns.y2]-rcIn[ns.y2]);ns.addTo(rcIn,[dx,dy]);},ptCenter:function(rc,scale)
{if(scale===undefined)
{scale=0.5;}
if(typeof scale==="number")
{scale=[scale,scale];}
var pt=ns.mult(scale,ns.lr(rc));scale=ns.sub([1,1],scale);ns.addTo(pt,ns.mult(scale,ns.ul(rc)));return pt;},ptRegistration:function(rc,iReg)
{var xScale=(iReg%3)*0.5;var yScale=Math.floor(iReg/3)*0.5;return ns.ptCenter(rc,[xScale,yScale]);},iRegClosest:function(pt,rc)
{var aPoints=[];for(var i=0;i<9;i++)
{aPoints.push(ns.ptRegistration(rc,i));}
return ns.IPtClosest(pt,aPoints)[0];},rectDeltaReg:function(rc,dpt,iReg,ptSizeMin,rcBounds)
{var rcT;if(iReg==4)
{rcT=ns.add(rc,dpt);if(rcBounds)
ns.keepInRect(rcT,rcBounds);return rcT;}
var iX=iReg%3;if(iX==1)
iX=undefined;var iY=Math.floor(iReg/3);if(iY==1)
iY=undefined;function ApplyDelta(rc,dpt)
{var rcDelta=[0,0,0,0];if(iX!=undefined)
rcDelta[iX]=dpt[0];if(iY!=undefined)
rcDelta[iY+1]=dpt[1];return ns.add(rc,rcDelta);}
rcT=ApplyDelta(rc,dpt);if(!ptSizeMin)
ptSizeMin=[0,0];var ptSize=ns.size(rcT);var ptFixSize=ns.max([0,0],ns.sub(ptSizeMin,ptSize));if(iX==0)
ptFixSize[0]*=-1;if(iY==0)
ptFixSize[1]*=-1;rcT=ApplyDelta(rcT,ptFixSize);if(rcBounds)
ns.keepInRect(rcT,rcBounds);return rcT;},iPtClosest:function(pt)
{var d2Min;var ptClosest;var iClosest;var d2;var iPt=0;for(var iarg=1;iarg<arguments.length;iarg++)
{var v=arguments[iarg];if(typeof v[0]=="number")
{d2=ns.Distance2(pt,v);if(d2Min==undefined||d2<d2Min)
{d2Min=d2;ptClosest=v;iClosest=iPt;}
iPt++;}
else
{for(var i=0;i<v.length;i++)
{vT=v[i];d2=ns.Distance2(pt,vT);if(d2Min==undefined||d2<d2Min)
{d2Min=d2;ptClosest=vT;iClosest=iPt;}
iPt++;}}}
return[iClosest,ptClosest];},distance2:function(v1,v2)
{var d2=0;for(var i=0;i<v1.length;i++)
d2+=Math.pow((v2[i]-v1[i]),2);return d2;},boundingBox:function()
{var vPoints=ns.append.apply(undefined,arguments);if(vPoints.length%2!==0)
{throw Error("Invalid arguments to boundingBox");}
var ptMin=vPoints.slice(0,2),ptMax=vPoints.slice(0,2);for(var ipt=2;ipt<vPoints.length;ipt+=2)
{var pt=vPoints.slice(ipt,ipt+2);if(pt[0]<ptMin[0])
{ptMin[0]=pt[0];}
if(pt[1]<ptMin[1])
{ptMin[1]=pt[1];}
if(pt[0]>ptMax[0])
{ptMax[0]=pt[0];}
if(pt[1]>ptMax[1])
{ptMax[1]=pt[1];}}
return[ptMin[0],ptMin[1],ptMax[0],ptMax[1]];},json:function(v)
{var sRect="[";var chSep="";for(i=0;i<v.length;i++)
{sRect+=chSep+v[i];chSep=",";}
sRect+="]";return sRect;}});ns.copy=ns.append;});
/* Begin file: dom.js */
global_namespace.define('org.startpad.DOM',function(NS){var Vector=NS.lookup('org.startpad.vector');NS.extend(NS,{x:0,y:1,x2:2,y2:3,PtClient:function(elt)
{var pt=[0,0];while(elt.offsetParent!==null)
{pt[0]+=elt.offsetLeft;pt[1]+=elt.offsetTop;elt=elt.offsetParent;}
return pt;},PtSize:function(elt)
{return[elt.offsetWidth,elt.offsetHeight];},RcClient:function(elt)
{var rc=NS.PtClient(elt);var ptSize=NS.PtSize(elt);rc.push(rc[NS.x]+ptSize[NS.x],rc[NS.y]+ptSize[NS.y]);return rc;},RcOffset:function(elt)
{var rc=[elt.offsetLeft,elt.offsetTop];var ptSize=NS.PtSize(elt);rc.push(rc[NS.x]+ptSize[NS.x],rc[NS.y]+ptSize[NS.y]);return rc;},PtMouse:function(evt)
{var x=document.documentElement.scrollLeft||document.body.scrollLeft;var y=document.documentElement.scrollTop||document.body.scrollTop;return[x+evt.clientX,y+evt.clientY];},RcWindow:function()
{var x=document.documentElement.scrollLeft||document.body.scrollLeft;var y=document.documentElement.scrollTop||document.body.scrollTop;var dx=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var dy=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return[x,y,x+dx,y+dy];},SetAbsPosition:function(elt,pt)
{elt.style.top=pt[1]+'px';elt.style.left=pt[0]+'px';},SetSize:function(elt,pt)
{elt.style.width=pt[0]+'px';elt.style.height=pt[1]+'px';},SetRc:function(elt,rc)
{this.SetAbsPosition(elt,Vector.UL(rc));this.SetSize(elt,Vector.Size(rc));},RemoveChildren:function(node)
{for(var child=node.firstChild;child;child=node.firstChild)
{node.removeChild(child);}},Ancestors:function(elem)
{var aAncestors=[];while(elem!=document)
{aAncestors.push(elem);elem=elem.parentNode;}
return aAncestors;},CommonAncestorHeight:function(elemChild,elemUncle)
{var aChild=NS.Ancestors(elemChild);var aUncle=NS.Ancestors(elemUncle);var iChild=aChild.length-1;var iUncle=aUncle.length-1;while(aChild[iChild]==aUncle[iUncle]&&iChild>=0)
{iChild--;iUncle--;}
return iChild+1;},SetFocusIfVisible:function(elt)
{if(!elt)
return;var rcElt=NS.RcClient(elt);var rcWin=NS.RcWindow();if(Vector.PtInRect(Vector.UL(rcElt),rcWin)||Vector.PtInRect(Vector.LR(rcElt),rcWin))
{elt.focus();}},ScrollToBottom:function(elt)
{elt.scrollTop=elt.scrollHeight;},BindIDs:function(aIDs)
{var mParts={};var i;if(aIDs===undefined)
{var aAll=document.getElementsByTagName("*");for(i=0;i<aAll.length;i++)
{var elt=aAll[i];if(elt.id&&elt.id[0]!='_')
mParts[elt.id]=elt;}
return mParts;}
for(i=0;i<aIDs.length;i++)
{var sID=aIDs[i];mParts[sID]=document.getElementById(sID);}
return mParts;},InitValues:function(aNames,mpFields,mpValues)
{for(var i=0;i<aNames.length;i++)
{if(mpValues[aNames[i]]!=undefined)
mpFields[aNames[i]].value=mpValues[aNames[i]];}},ReadValues:function(aNames,mpFields,mpValues)
{for(var i=0;i<aNames.length;i++)
{var field=mpFields[aNames[i]];var value;if(field.type=='checkbox')
value=field.checked;else
value=field.value;mpValues[aNames[i]]=value;}},$:function(sSelector)
{var ch=sSelector.substr(0,1);if(ch=='.'||ch=='#')
sSelector=sSelector.substr(1);if(ch=='#')
return document.getElementById(sSelector);if(ch=='.')
return NS.GetElementsByClassName(sSelector);return document.getElementsByTagName(sSelector);},GetElementsByClassName:function(sClassName)
{if(document.getElementsByClassName)
return document.getElementsByClassName(sClassName);return NS.GetElementsByTagClassName(document,"*",sClassName);},GetElementsByTagClassName:function(oElm,strTagName,strClassName)
{var arrElements=(strTagName=="*"&&oElm.all)?oElm.all:oElm.getElementsByTagName(strTagName);var arrReturnElements=new Array();strClassName=strClassName.replace(/\-/g,"\\-");var oRegExp=new RegExp("(^|\\s)"+strClassName+"(\\s|$)");var oElement;for(var i=0;i<arrElements.length;i++)
{oElement=arrElements[i];if(oRegExp.test(oElement.className))
{arrReturnElements.push(oElement);}}
return(arrReturnElements);},GetText:function(elt)
{var sText=elt.textContent||elt.innerText||"";return sText.Trim();},SetText:function(elt,st)
{if(elt.textContent!=undefined)
elt.textContent=st;else
elt.innerText=st;}});});
/* Begin file: json2.js */
global_namespace.define('org.json.json2',function(JSON){function f(n){return n<10?'0'+n:n;}
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+
partial.join(',\n'+gap)+'\n'+
mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==='string'){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+
mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}
return str('',{'':value});};}
if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+
('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');};}});
/* Begin file: crypto.js */
global_namespace.define("com.googlecode.crypto-js",function(){});(function(){var base64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var Crypto=global_namespace.lookup("com.googlecode.crypto-js");var util=Crypto.util={rotl:function(n,b){return(n<<b)|(n>>>(32-b));},rotr:function(n,b){return(n<<(32-b))|(n>>>b);},endian:function(n){if(n.constructor==Number){return util.rotl(n,8)&0x00FF00FF|util.rotl(n,24)&0xFF00FF00;}
for(var i=0;i<n.length;i++)
n[i]=util.endian(n[i]);return n;},randomBytes:function(n){for(var bytes=[];n>0;n--)
bytes.push(Math.floor(Math.random()*256));return bytes;},bytesToWords:function(bytes){for(var words=[],i=0,b=0;i<bytes.length;i++,b+=8)
words[b>>>5]|=bytes[i]<<(24-b%32);return words;},wordsToBytes:function(words){for(var bytes=[],b=0;b<words.length*32;b+=8)
bytes.push((words[b>>>5]>>>(24-b%32))&0xFF);return bytes;},bytesToHex:function(bytes){for(var hex=[],i=0;i<bytes.length;i++){hex.push((bytes[i]>>>4).toString(16));hex.push((bytes[i]&0xF).toString(16));}
return hex.join("");},hexToBytes:function(hex){for(var bytes=[],c=0;c<hex.length;c+=2)
bytes.push(parseInt(hex.substr(c,2),16));return bytes;},bytesToBase64:function(bytes){if(typeof btoa=="function")return btoa(Binary.bytesToString(bytes));for(var base64=[],i=0;i<bytes.length;i+=3){var triplet=(bytes[i]<<16)|(bytes[i+1]<<8)|bytes[i+2];for(var j=0;j<4;j++){if(i*8+j*6<=bytes.length*8)
base64.push(base64map.charAt((triplet>>>6*(3-j))&0x3F));else base64.push("=");}}
return base64.join("");},base64ToBytes:function(base64){if(typeof atob=="function")return Binary.stringToBytes(atob(base64));base64=base64.replace(/[^A-Z0-9+\/]/ig,"");for(var bytes=[],i=0,imod4=0;i<base64.length;imod4=++i%4){if(imod4==0)continue;bytes.push(((base64map.indexOf(base64.charAt(i-1))&(Math.pow(2,-2*imod4+8)-1))<<(imod4*2))|(base64map.indexOf(base64.charAt(i))>>>(6-imod4*2)));}
return bytes;}};Crypto.mode={};var charenc=Crypto.charenc={};var UTF8=charenc.UTF8={stringToBytes:function(str){return Binary.stringToBytes(unescape(encodeURIComponent(str)));},bytesToString:function(bytes){return decodeURIComponent(escape(Binary.bytesToString(bytes)));}};var Binary=charenc.Binary={stringToBytes:function(str){for(var bytes=[],i=0;i<str.length;i++)
bytes.push(str.charCodeAt(i));return bytes;},bytesToString:function(bytes){for(var str=[],i=0;i<bytes.length;i++)
str.push(String.fromCharCode(bytes[i]));return str.join("");}};})();(function(){var C=global_namespace.lookup("com.googlecode.crypto-js"),util=C.util,charenc=C.charenc,UTF8=charenc.UTF8,Binary=charenc.Binary;var SHA1=C.SHA1=function(message,options){var digestbytes=util.wordsToBytes(SHA1._sha1(message));return options&&options.asBytes?digestbytes:options&&options.asString?Binary.bytesToString(digestbytes):util.bytesToHex(digestbytes);};SHA1._sha1=function(message){if(message.constructor==String)message=UTF8.stringToBytes(message);var m=util.bytesToWords(message),l=message.length*8,w=[],H0=1732584193,H1=-271733879,H2=-1732584194,H3=271733878,H4=-1009589776;m[l>>5]|=0x80<<(24-l%32);m[((l+64>>>9)<<4)+15]=l;for(var i=0;i<m.length;i+=16){var a=H0,b=H1,c=H2,d=H3,e=H4;for(var j=0;j<80;j++){if(j<16)w[j]=m[i+j];else{var n=w[j-3]^w[j-8]^w[j-14]^w[j-16];w[j]=(n<<1)|(n>>>31);}
var t=((H0<<5)|(H0>>>27))+H4+(w[j]>>>0)+(j<20?(H1&H2|~H1&H3)+1518500249:j<40?(H1^H2^H3)+1859775393:j<60?(H1&H2|H1&H3|H2&H3)-1894007588:(H1^H2^H3)-899497514);H4=H3;H3=H2;H2=(H1<<30)|(H1>>>2);H1=H0;H0=t;}
H0+=a;H1+=b;H2+=c;H3+=d;H4+=e;}
return[H0,H1,H2,H3,H4];};SHA1._blocksize=16;})();(function(){var C=global_namespace.lookup("com.googlecode.crypto-js"),util=C.util,charenc=C.charenc,UTF8=charenc.UTF8,Binary=charenc.Binary;C.HMAC=function(hasher,message,key,options){if(message.constructor==String)message=UTF8.stringToBytes(message);if(key.constructor==String)key=UTF8.stringToBytes(key);if(key.length>hasher._blocksize*4)
key=hasher(key,{asBytes:true});var okey=key.slice(0),ikey=key.slice(0);for(var i=0;i<hasher._blocksize*4;i++){okey[i]^=0x5C;ikey[i]^=0x36;}
var hmacbytes=hasher(okey.concat(hasher(ikey.concat(message),{asBytes:true})),{asBytes:true});return options&&options.asBytes?hmacbytes:options&&options.asString?Binary.bytesToString(hmacbytes):util.bytesToHex(hmacbytes);};})();(function(){var C=global_namespace.lookup("com.googlecode.crypto-js");C.HMAC_SHA1=function(key,message,options){return C.HMAC(C.SHA1,message,key,options);};})();
/* Begin file: timer.js */
global_namespace.define('org.startpad.timer',function(NS){NS.extend(NS,{MSNow:function()
{return new Date().getTime();}});NS.Timer=function(ms,fnCallback)
{this.ms=ms;this.fnCallback=fnCallback;return this;};NS.Timer.prototype={constructor:NS.Timer,fActive:false,fRepeat:false,fInCallback:false,fReschedule:false,Repeat:function(f)
{if(f===undefined)
{f=true;}
this.fRepeat=f;return this;},Ping:function()
{if(!this.fActive)
{return;}
if(this.fInCallback)
{this.fReschedule=true;return;}
this.fInCallback=true;try
{this.fnCallback();}
catch(e)
{console.error("Error in timer callback: "+e.message+"("+e.name+")");}
this.fInCallback=false;if(this.fActive&&(this.fRepeat||this.fReschedule))
{this.Active(true);}},Active:function(fActive)
{if(fActive===undefined)
{fActive=true;}
this.fActive=fActive;this.fReschedule=false;if(this.iTimer)
{window.clearTimeout(this.iTimer);this.iTimer=undefined;}
if(fActive)
{this.iTimer=window.setTimeout(this.Ping.FnMethod(this),this.ms);}
return this;}};});
/* Begin file: events.js */
global_namespace.define('org.startpad.events',function(NS){var DOM=NS.lookup('org.startpad.DOM');var Vector=NS.lookup('org.startpad.vector');NS.extend(NS,{fnHandlers:[],AddEventFn:function(elem,stEvt,fnCallback,fCapture)
{if(!fCapture)
fCapture=false;var fnWrap=function(){arguments[0]=NS.WrapEvent(arguments[0]);return fnCallback.apply(elem,arguments);};if(elem.addEventListener)
{elem.addEventListener(stEvt,fnWrap,fCapture);}
else if(elem.attachEvent)
{elem.attachEvent('on'+stEvt,fnWrap);}
else
{elem['on'+stEvt]=fnWrap;}
NS.fnHandlers.push({elem:elem,evt:stEvt,fCapture:fCapture,fn:fnWrap});return NS.fnHandlers.length-1;},RemoveEventFn:function(ifn)
{var fnHand=NS.fnHandlers[ifn];if(!fnHand)
{return;}
NS.fnHandlers[ifn]=undefined;var elem=fnHand.elem;if(elem.removeEventListener)
{elem.removeEventListener(fnHand.evt,fnHand.fn,fnHand.fCapture);}
else if(elem.attachEvent)
{elem.detachEvent('on'+fnHand.evt,fnHand.fn);}
else
{elem['on'+fnHand.evt]=undefined;}},WrapEvent:function(evt)
{evt=evt||window.evt||{};if(!evt.preventDefault)
{evt.preventDefault=function(){this.returnValue=false;};}
if(!evt.stopPropagation)
evt.stopPropagation=function(){this.cancelBubble=true;};if(!evt.target)
evt.target=evt.srcElement||document;if(evt.pageX==null&&evt.clientX!=null){var doc=document.documentElement,body=document.body;evt.pageX=evt.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc.clientLeft||0);evt.pageY=evt.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc.clientTop||0);}
return evt;},GetChar:function(evt)
{var code=evt.keyCode||evt.which;return String.fromCharCode(code);},DisableSelection:function(elt)
{elt.style.cursor="default";NS.AddEventFn(elt,'mousedown',function(evt){evt.preventDefault();return false;});},aCursors:['nw-resize','n-resize','ne-resize','w-resize','move','e-resize','sw-resize','s-resize','se-resize'],Draggable:function(elem,fnCallback,opt)
{var fDragging=false;var ptMouse,ptStart,ptLast;var dResize=4;var iReg=4;opt=NS.Extend({fInclusive:false,fResize:false,rcBounds:null,fnCallback:null},opt);var rcElem;var rcClient;NS.AddEventFn(elem,'mousedown',function(evt){if(!opt.fInclusive&&evt.target!=elem)
return;evt.preventDefault();evt.stopPropagation();fDragging=true;ptStart=[evt.pageX,evt.pageY];ptLast=ptStart;if(opt.fnStart)
opt.fnStart();return false;},false);NS.AddEventFn(document,'mousemove',function(evt){var ptNow=[evt.pageX,evt.pageY];if(!fDragging)
{rcElem=DOM.RcOffset(elem);rcClient=DOM.RcClient(elem);if(!Vector.PtInRect(ptNow,rcClient))
return true;iReg=opt.fResize?Vector.IRegClosest(ptNow,rcClient):4;elem.style.cursor=NS.aCursors[iReg];return true;}
evt.preventDefault();evt.stopPropagation();if(Vector.Equal(ptNow,ptLast))
return false;ptLast=ptNow;if(opt.fnMove)
{opt.fnMove(Vector.Sub(ptNow,ptStart));return false;}
var dpt=Vector.Sub(ptNow,ptStart);var rcNew=Vector.RectDeltaReg(rcElem,dpt,iReg,[12,12],opt.rcBounds);DOM.SetRc(elem,rcNew);return false;},false);NS.AddEventFn(document,'mouseup',function(evt){if(!fDragging)
return true;fDragging=false;evt.preventDefault();evt.stopPropagation();if(fnCallback)
fnCallback(Vector.Sub(ptLast,ptStart));return false;},false);}});});
/* Begin file: registration.js */
global_namespace.define('com.pageforest.registration',function(ns){function html_message(name,message){if($("#id_"+name).val()===''){return'';}
if(message){return'<span class="error">'+message+'</span>';}
return'<span class="success">OK</span>';}
function validate_success(message,status,xhr){var fields={"username":"username","email":"email","password":"password","repeat":"__all__"};for(var name in fields){if(ns.isOwn(fields,name)){$("#validate_"+name).html(html_message(name,message[fields[name]]));}}}
function validate_error(xhr,status,message){console.error(xhr);}
function validate_if_changed(){var data={username:$("#id_username").val(),email:$("#id_email").val(),password:$("#id_password").val(),repeat:$("#id_repeat").val(),tos:$("#id_tos").attr('checked')?'checked':''};var oneline=[data.username,data.email,data.password,data.repeat];oneline=oneline.join('~');if(oneline==ns.previous){return;}
ns.previous=oneline;console.log('validating: '+oneline);$.ajax({type:"POST",url:"/auth/validate",data:data,dataType:"json",success:validate_success,error:validate_error});}
ns.document_ready=function(){ns.previous='~~~';setInterval(validate_if_changed,3000);$("#id_tos").click(function(){$("#validate_tos").html('');});};});
/* Begin file: formatutil.js */
global_namespace.define('org.startpad.format-util',function(NS){NS.extend(NS,{Thousands:function(d)
{var s=d.toString();var sLast="";while(s!=sLast)
{sLast=s;s=s.replace(/(\d+)(\d{3})/,"$1,$2");}
return s;},Slugify:function(s)
{s=s.Trim().toLowerCase();s=s.replace(/[^\w\s-]/g,'-').replace(/[-\s]+/g,'-').replace(/(^-+)|(-+$)/g,'');return s;},FormatNumber:function(val,digits)
{var nInt=Math.floor(val);var sInt=nInt.toString();var sLast="";while(sInt!=sLast)
{sLast=sInt;sInt=sInt.replace(/(\d+)(\d{3})/,"$1,$2");}
if(digits&&digits>0)
{var nFrac=val-nInt;nFrac=Math.floor(nFrac*Math.pow(10,digits));sFrac="."+SDigits(nFrac,digits);}
else
sFrac="";return sInt+sFrac;},SDigits:function(val,c,fSign)
{var s="";var fNeg=(val<0);if(c==undefined)
c=0;if(fNeg)
val=-val;val=Math.floor(val);for(;c>0;c--)
{s=(val%10)+s;val=Math.floor(val/10);}
if(fSign||fNeg)
s=(fNeg?"-":"+")+s;return s;},EscapeHTML:function(s)
{s=s.toString();s=s.replace(/&/g,'&amp;');s=s.replace(/</g,'&lt;');s=s.replace(/>/g,'&gt;');s=s.replace(/\"/g,'&quot;');s=s.replace(/'/g,'&#39;');return s;},ReplaceKeys:function(st,keys)
{for(var key in keys)
st=st.StReplace("{"+key+"}",keys[key]);st=st.replace(/\{[^\{\}]*\}/g,"");return st;}});String.prototype.Trim=function()
{return(this||"").replace(/^\s+|\s+$/g,"");};String.prototype.StReplace=function(stPat,stRep)
{var st="";if(stRep==undefined)
stRep="";else
stRep=stRep.toString();var ich=0;var ichFind=this.indexOf(stPat,0);while(ichFind>=0)
{st+=this.substring(ich,ichFind)+stRep;ich=ichFind+stPat.length;ichFind=this.indexOf(stPat,ich);}
st+=this.substring(ich);return st;};});
/* Begin file: dateutil.js */
global_namespace.define('org.startpad.date-util',function(NS){var Base=NS.lookup('org.startpad.base');var Format=NS.lookup('org.startpad.format-util');NS.ISO={tz:-(new Date().getTimezoneOffset())/60,enumMatch:new Base.Enum([1,"YYYY","MM","DD",5,"hh","mm",8,"ss",10,"sss","tz"]),FromDate:function(dt,fTime)
{var dtT=new Date();dtT.setTime(dt.getTime());var tz=dt.__tz;if(tz==undefined)
tz=NS.ISO.tz;if(tz)
dtT.setTime(dtT.getTime()+60*60*1000*tz);var s=dtT.getUTCFullYear()+"-"+Format.SDigits(dtT.getUTCMonth()+1,2)+"-"+Format.SDigits(dtT.getUTCDate(),2);var ms=dtT%(24*60*60*1000);if(ms||fTime||tz!=0)
{s+="T"+Format.SDigits(dtT.getUTCHours(),2)+":"+Format.SDigits(dtT.getUTCMinutes(),2);ms=ms%(60*1000);if(ms)
s+=":"+Format.SDigits(dtT.getUTCSeconds(),2);if(ms%1000)
s+="."+Format.SDigits(dtT.getUTCMilliseconds(),3);if(tz==0)
s+="Z";else
s+=Format.SDigits(tz,2,true);}
return s;},ToDate:function(sISO,objExtra)
{var e=NS.ISO.enumMatch;var aParts=sISO.match(/^(\d{4})-?(\d\d)-?(\d\d)(T(\d\d):?(\d\d):?((\d\d)(\.(\d{0,6}))?)?(Z|[\+-]\d\d))?$/);if(!aParts)
return undefined;aParts[e.mm]=aParts[e.mm]||0;aParts[e.ss]=aParts[e.ss]||0;aParts[e.sss]=aParts[e.sss]||0;aParts[e.sss]=Math.round(+('0.'+aParts[e.sss])*1000);if(!aParts[e.tz]||aParts[e.tz]==="Z")
aParts[e.tz]=0;else
aParts[e.tz]=parseInt(aParts[e.tz]);if(aParts[e.MM]>59||aParts[e.DD]>31||aParts[e.hh]>23||aParts[e.mm]>59||aParts[e.ss]>59||aParts[e.tz]<-23||aParts[e.tz]>23)
return undefined;var dt=new Date();dt.setUTCFullYear(aParts[e.YYYY],aParts[e.MM]-1,aParts[e.DD]);if(aParts[e.hh])
{dt.setUTCHours(aParts[e.hh],aParts[e.mm],aParts[e.ss],aParts[e.sss]);}
else
dt.setUTCHours(0,0,0,0);dt.__tz=aParts[e.tz];if(aParts[e.tz])
dt.setTime(dt.getTime()-dt.__tz*(60*60*1000));if(objExtra)
NS.Extend(dt,objExtra);return dt;}};});
/* Begin file: data.js */
global_namespace.define('org.startpad.data',function(NS){var DateUtil=NS.lookup('org.startpad.date-util');var Timer=NS.lookup('org.startpad.timer');var JSON=NS.lookup('org.json.json2');var Base=NS.lookup('org.startpad.base');var Event=NS.lookup('org.startpad.events');var Format=NS.lookup('org.startpad.format-util');NS.extend(NS,{sSiteName:"web",apikey:undefined,sid:undefined,afn:[],ifn:1,mMessages:{errBusy:"Call made while another call is in progress."},SetSiteName:function(sName)
{NS.sSiteName=sName;},GetAPIKey:function(sDomain,fnNext)
{if(NS.apikey!=undefined)
return fnNext();new NS.ScriptData("http://"+sDomain+"/init.json").Call({},function(obj)
{if(obj.status!="OK")
{alert(obj.message);return;}
NS.apikey=obj.apikey;NS.sid=obj.sid;fnNext();});},StParams:function(obj)
{if(obj===undefined||obj===null)
{return"";}
var stDelim="?";var stParams="";for(var prop in obj)
{var sVal;if(!obj.hasOwnProperty(prop)||obj[prop]===undefined||obj[prop]==null)
continue;stParams+=stDelim;stParams+=encodeURIComponent(prop);if(typeof obj[prop]=="object")
{if(obj[prop].constructor===Date)
sVal=DateUtil.ISO.FromDate(obj[prop]);else
sVal=JSON.stringify(obj[prop]);}
else
sVal=obj[prop].toString();stParams+="="+encodeURIComponent(sVal);stDelim="&";}
if(obj._anchor)
{stParams+="#"+encodeURIComponent(obj._anchor);}
return stParams;},ParseParams:function(stURL)
{var rgQuery=stURL.match(/([^?#]*)(#.*)?$/);if(!rgQuery)
{return{};}
var objParse={};if(rgQuery[2])
{objParse._anchor=decodeURIComponent(rgQuery[2].substring(1));}
var rgParams=rgQuery[1].split("&");for(var i=0;i<rgParams.length;i++)
{var ich=rgParams[i].indexOf("=");var stName;var stValue;if(ich===-1)
{stName=rgParams[i];stValue="";continue;}
else
{stName=rgParams[i].substring(0,ich);stValue=rgParams[i].substring(ich+1);}
objParse[decodeURIComponent(stName)]=decodeURIComponent(stValue);}
return objParse;}});NS.ScriptData=function(stURL,fnCallback)
{this.stURL=stURL;this.fnCallback=fnCallback;this.rid=0;this.fInCall=false;this.Activate();return this;};NS.ScriptData.prototype={constructor:NS.ScriptData,rid:0,msTimeout:10000,cchMax:1000,Activate:function()
{if(this.rid!=0)
return;this.rid=NS.ifn++;NS.afn[this.rid]=this;},Call:function(objParams,fnCallback)
{this.Activate();if(this.fInCall)
throw(new Error(NS.mMessages.errBusy));this.fInCall=true;Base.ExtendMissing(objParams,{apikey:NS.apikey});if(fnCallback)
this.fnCallback=fnCallback;if(objParams===undefined)
objParams={};objParams.callback=this.CallbackName();this.script=document.createElement('script');this.script.src=this.stURL+NS.StParams(objParams);if(this.script.src.length>this.cchMax)
{var pd=new NS.PostData(this.stURL,this.fnCallback);pd.Call(objParams);this.Cancel();return;}
this.tm=new Timer.Timer(this.msTimeout,this.Timeout.FnMethod(this)).Active(true);this.dCall=new Date();document.body.appendChild(this.script);console.info("script["+this.rid+"]: "+this.script.src);return this;},CallbackName:function()
{return NS.SGlobalName("afn")+"["+this.rid+"].Callback";},Callback:function()
{var rid=this.rid;this.Cancel();console.info("("+rid+") -> ",arguments);if(this.fnCallback)
this.fnCallback.apply(undefined,arguments);},Timeout:function()
{var rid=this.rid;console.info("("+rid+") -> TIMEOUT");this.Cancel();if(this.fnCallback)
this.fnCallback({status:"Fail/Timeout",message:"The "+NS.sSiteName+" server failed to respond."});},Cancel:function()
{NS.ScriptData.Cancel(this.rid);}};NS.ScriptData.Cancel=function(rid)
{if(rid==0)
return;var sd=NS.afn[rid];NS.afn[rid]=undefined;if(sd&&sd.rid==rid)
{sd.rid=0;sd.fInCall=false;if(sd.tm)
sd.tm.Active(false);}};NS.PostData=function(stURL,fnCallback)
{this.stURL=stURL;this.fnCallback=fnCallback;return this;};NS.PostData.prototype={constructor:NS.PostData,msTimeout:10000,Call:function(objParams,fnCallback)
{if(fnCallback)
this.fnCallback=fnCallback;Base.ExtendMissing(objParams,{apikey:NS.apikey});var reDomain=/^http:\/\/[^\/]+/;var sDomain='';var aDomain=reDomain.exec(this.stURL);if(aDomain!=null)
sDomain=aDomain[0];var sGetResult=sDomain+'/get-result.json';this.sd=new NS.ScriptData(sGetResult,this.fnCallback);if(objParams===undefined)
objParams={};objParams.rid=this.sd.rid;objParams.sid=NS.sid;objParams.callback=this.sd.CallbackName();this.iframe=document.createElement("iframe");this.iframe.style.width="0px";this.iframe.style.height="0px";this.iframe.style.border="0px";document.body.appendChild(this.iframe);this.doc=this.iframe.contentDocument||this.iframe.contentWindow.document;console.info("post["+this.sd.rid+"]: "+this.stURL);var stb=new Base.StBuf();stb.Append("<html><body><form name=\"PostData\" action=\""+this.stURL+"\" method=\"post\">");for(var prop in objParams)
{var sValue;if(!objParams.hasOwnProperty(prop))
continue;stb.Append("<input type=\"text\" name=\""+prop+"\" value='");if(typeof objParams[prop]=='object')
{if(objParams[prop].constructor===Date)
sValue=DateUtil.ISO.FromDate(objParams[prop]);else
sValue=JSON.stringify(objParams[prop]);}
else
{sValue=Format.EscapeHTML(objParams[prop]);}
stb.Append(sValue);stb.Append("'>");console.info("    "+prop+": "+sValue);}
stb.Append("</input></form></body></html>");Event.AddEventFn(this.iframe,"load",this.Loaded.FnMethod(this).FnArgs(this.rid));this.doc.write(stb.toString());this.tm=new Timer.Timer(this.msTimeout,this.Timeout.FnMethod(this)).Active(true);this.msCallStart=new Date().getTime();this.doc.PostData.submit();},Loaded:function(evt)
{this.tm.Active(false);this.msResponse=new Date().getTime()-this.msCallStart;console.info("("+this.sd.rid+") -> POST COMPLETE "+this.msResponse+" ms");this.sd.Call({sid:NS.sid,ridPost:this.sd.rid});},Timeout:function()
{this.sd.Timeout();},Cancel:function()
{this.sd.Cancel();this.tm.Active(false);}};});
